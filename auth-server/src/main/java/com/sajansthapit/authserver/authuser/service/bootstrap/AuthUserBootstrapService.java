package com.sajansthapit.authserver.authuser.service.bootstrap;import com.sajansthapit.authserver.authuser.model.AuthRole;import com.sajansthapit.authserver.authuser.model.AuthUser;import com.sajansthapit.authserver.authuser.repository.AuthUserRepository;import com.sajansthapit.authserver.authuser.service.IAuthRoleService;import com.sajansthapit.authserver.config.bootstrap.dto.BootstrapUserDto;import com.sajansthapit.authserver.config.bootstrap.service.BootstrapData;import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;import org.springframework.stereotype.Service;import java.util.HashSet;import java.util.Set;import java.util.UUID;@Servicepublic class AuthUserBootstrapService implements BootstrapData<BootstrapUserDto> {    private static final String BCRYPT_ENCODER = "{bcrypt}";    private final AuthUserRepository authUserRepository;    private final IAuthRoleService authRoleService;    public AuthUserBootstrapService(AuthUserRepository authUserRepository, IAuthRoleService authRoleService) {        this.authUserRepository = authUserRepository;        this.authRoleService = authRoleService;    }    @Override    public void bootstrap(BootstrapUserDto bootstrapUserDto) {        AuthUser authUser = new AuthUser();        authUser.setId(UUID.randomUUID().toString());        authUser.setEmail(bootstrapUserDto.getEmail());        authUser.setFullName(bootstrapUserDto.getFullName());        authUser.setUsername(bootstrapUserDto.getUsername());        authUser.setPassword(BCRYPT_ENCODER.concat(new BCryptPasswordEncoder().encode(bootstrapUserDto.getPassword())));        Set<AuthRole> roles = new HashSet<>();        bootstrapUserDto.getRoles().forEach(role ->                roles.add(authRoleService.getByName(role))        );        authUser.setAuthRoles(roles);        authUser.setAccountNonExpired(true);        authUser.setAccountNonLocked(true);        authUser.setCredentialNonExpired(true);        authUser.setEnabled(true);        authUserRepository.save(authUser);    }    public long getTotalUser() {        return authUserRepository.count();    }}